# # Workflowì˜ ì´ë¦„
# # Workflow : í•˜ë‚˜ì˜ yml íŒŒì¼ì„ í•˜ë‚˜ì˜ Workflowë¼ê³  ë¶€ë¥¸ë‹¤.
# name: Github Actions ì—°ìŠµí•˜ê¸°

# # Event : ì‹¤í–‰ë˜ëŠ” ì‹œì ì„ ì„¤ì •
# # mainì´ë¼ëŠ” ë¸Œëœì¹˜ì— push ë  ë•Œ ì•„ë˜ Workflowë¥¼ ì‹¤í–‰
# on:
#   push:
#     branches:
#       - main
#   pull_request:
#     branches:
#       - "**"

# # PRì— ëŒ“ê¸€ì„ ë‹¬ë ¤ë©´ ê¶Œí•œ ì„¤ì • í•„ìš”
# permissions:
#   contents: read
#   pull-requests: write

# # concurrency ì„¤ì • ì¶”ê°€
# concurrency:
#   group: ${{ github.workflow }}-${{ github.ref }} # ì›Œí¬í”Œë¡œìš° ì´ë¦„ê³¼ ë¸Œëœì¹˜ ì´ë¦„ì„ ê·¸ë£¹ìœ¼ë¡œ ë¬¶ì–´ì„œ ì‹¤í–‰
#   cancel-in-progress: true # ì´ë¯¸ ì‹¤í–‰ ì¤‘ì¸ ì´ì „ ì›Œí¬í”Œë¡œìš°ë¥¼ ì·¨ì†Œí•©ë‹ˆë‹¤

# # í•˜ë‚˜ì˜ WorkflowëŠ” 1ê°œ ì´ìƒì˜ Jobìœ¼ë¡œ êµ¬ì„±ëœë‹¤.
# # ì—¬ëŸ¬ Jobì€ ê¸°ë³¸ì ìœ¼ë¡œ ë³‘ë ¬ì ìœ¼ë¡œ ìˆ˜í–‰ëœë‹¤.
# jobs:
#   # Jobì„ ì‹ë³„í•˜ê¸° ìœ„í•œ id -> ì´ë¦„ì€ ììœ ë¡­ê²Œ ì‘ì„±

#   my-job:
#     # Github Actionsë¥¼ ì‹¤í–‰ì‹œí‚¬ ì„œë²„ ì¢…ë¥˜ ì„ íƒ
#     runs-on: ubuntu-latest

#     # Step : íŠ¹ì • ì‘ì—…ì„ ìˆ˜í–‰í•˜ëŠ” ê°€ì¥ ì‘ì€ ë‹¨ìœ„
#     # Jobì€ ì—¬ëŸ¬ Stepë“¤ë¡œ êµ¬ì„±ë˜ì–´ ìˆë‹¤.
#     steps:
#       - name: Github Repository íŒŒì¼ ê°€ì ¸ì˜¤ê¸°
#         uses: actions/checkout@v4

#       - name: Node ì„¤ì¹˜
#         uses: actions/setup-node@v4
#         with:
#           node-version: 20

#       - name: ì˜ì¡´ì„±(ë¼ì´ë¸ŒëŸ¬ë¦¬) ì„¤ì¹˜
#         run: npm ci

#       - name: Run tests with coverage
#         run: npm test -- --coverage

#       - name: Extract coverage data
#         id: coverage
#         run: |
#           # ë‹¤ì–‘í•œ ì»¤ë²„ë¦¬ì§€ ì§€í‘œ ì¶”ì¶œ
#           STATEMENTS=$(cat coverage/coverage-summary.json | jq -r '.total.statements.pct')
#           BRANCHES=$(cat coverage/coverage-summary.json | jq -r '.total.branches.pct')
#           FUNCTIONS=$(cat coverage/coverage-summary.json | jq -r '.total.functions.pct')
#           LINES=$(cat coverage/coverage-summary.json | jq -r '.total.lines.pct')

#           # ì¶œë ¥ ì„¤ì •
#           echo "statements=$STATEMENTS" >> $GITHUB_OUTPUT
#           echo "branches=$BRANCHES" >> $GITHUB_OUTPUT
#           echo "functions=$FUNCTIONS" >> $GITHUB_OUTPUT
#           echo "lines=$LINES" >> $GITHUB_OUTPUT

#       - name: Comment PR
#         if: github.event_name == 'pull_request'
#         run: |
#           # ê° ì»¤ë²„ë¦¬ì§€ ì§€í‘œ
#           STATEMENTS="${{ steps.coverage.outputs.statements }}"
#           BRANCHES="${{ steps.coverage.outputs.branches }}"
#           FUNCTIONS="${{ steps.coverage.outputs.functions }}"
#           LINES="${{ steps.coverage.outputs.lines }}"

#           gh pr comment ${{ github.event.pull_request.number }} --body "## ì½”ë“œ ì»¤ë²„ë¦¬ì§€ ë¦¬í¬íŠ¸ ğŸ“Š

#           | ì§€í‘œ | ì»¤ë²„ë¦¬ì§€ |
#           | --- | --- |
#           | êµ¬ë¬¸(Statements) | ${STATEMENTS}% |
#           | ë¶„ê¸°(Branches) | ${BRANCHES}% |
#           | í•¨ìˆ˜(Functions) | ${FUNCTIONS}% |
#           | ë¼ì¸(Lines) | ${LINES}% |

#           [ìì„¸í•œ ë¦¬í¬íŠ¸ ë³´ê¸°](https://github.com/${{ github.repository }}/actions/runs/${{ github.run_id }})"
#         env:
#           GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
